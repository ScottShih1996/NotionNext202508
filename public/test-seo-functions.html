<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SEO分析工具功能测试</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f8f9fa;
        }

        .container {
            background: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 12px;
        }

        .test-section {
            margin: 30px 0;
            padding: 20px;
            border: 2px solid #e9ecef;
            border-radius: 8px;
        }

        .test-section h2 {
            color: #495057;
            border-bottom: 2px solid #007bff;
            padding-bottom: 10px;
        }

        .result-box {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 6px;
            margin: 10px 0;
            border-left: 4px solid #007bff;
        }

        .error-box {
            background: #f8d7da;
            color: #721c24;
            padding: 15px;
            border-radius: 6px;
            margin: 10px 0;
            border-left: 4px solid #dc3545;
        }

        .success-box {
            background: #d4edda;
            color: #155724;
            padding: 15px;
            border-radius: 6px;
            margin: 10px 0;
            border-left: 4px solid #28a745;
        }

        button {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            margin: 5px;
        }

        button:hover {
            background: #0056b3;
        }

        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid #007bff;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }

            100% {
                transform: rotate(360deg);
            }
        }

        .score-circle {
            display: inline-block;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            text-align: center;
            line-height: 60px;
            color: white;
            font-weight: bold;
            margin: 10px;
        }

        .score-excellent {
            background: #28a745;
        }

        .score-good {
            background: #007bff;
        }

        .score-fair {
            background: #ffc107;
            color: #212529;
        }

        .score-poor {
            background: #fd7e14;
        }

        .score-very-poor {
            background: #dc3545;
        }

        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .card {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        pre {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 6px;
            overflow-x: auto;
            font-size: 14px;
        }
    </style>
</head>

<body>
    <div class="header">
        <h1>🔍 SEO内容分析工具功能测试</h1>
        <p>测试和验证SEO分析工具的各项功能</p>
    </div>

    <div class="container">
        <div class="test-section">
            <h2>📊 综合SEO分析测试</h2>
            <p>测试完整的SEO内容分析功能，包括关键词、标题、可读性和链接分析。</p>
            <button onclick="testFullAnalysis()">开始综合分析</button>
            <div id="fullAnalysisResult"></div>
        </div>

        <div class="test-section">
            <h2>🔤 关键词密度分析测试</h2>
            <p>测试关键词密度计算和优化建议功能。</p>
            <button onclick="testKeywordAnalysis()">测试关键词分析</button>
            <div id="keywordResult"></div>
        </div>

        <div class="test-section">
            <h2>📝 标题结构检查测试</h2>
            <p>测试HTML标题层级结构的检查功能。</p>
            <button onclick="testHeadingStructure()">测试标题结构</button>
            <div id="headingResult"></div>
        </div>

        <div class="test-section">
            <h2>📖 可读性分析测试</h2>
            <p>测试内容可读性评估和Flesch评分计算。</p>
            <button onclick="testReadability()">测试可读性分析</button>
            <div id="readabilityResult"></div>
        </div>

        <div class="test-section">
            <h2>🔗 内部链接分析测试</h2>
            <p>测试内部链接密度和质量分析功能。</p>
            <button onclick="testLinkAnalysis()">测试链接分析</button>
            <div id="linkResult"></div>
        </div>
    </div>

    <div class="container">
        <h2>📋 测试用例说明</h2>
        <div class="grid">
            <div class="card">
                <h3>测试内容特点</h3>
                <ul>
                    <li>包含多层级标题结构</li>
                    <li>故意的SEO问题（用于测试检测能力）</li>
                    <li>不同长度的句子和段落</li>
                    <li>各种类型的内部链接</li>
                    <li>中英文混合内容</li>
                </ul>
            </div>
            <div class="card">
                <h3>预期检测问题</h3>
                <ul>
                    <li>关键词密度过高</li>
                    <li>标题层级跳跃</li>
                    <li>句子过长影响可读性</li>
                    <li>空锚文本链接</li>
                    <li>非描述性链接文本</li>
                </ul>
            </div>
        </div>
    </div>

    <script>
        // 测试用的HTML内容
        const testContent = `
            <h1>SEO优化完整指南：提升网站搜索排名的终极策略</h1>
            
            <p>SEO搜索引擎优化是现代网站成功的关键。SEO技术可以显著提高网站在搜索引擎中的排名。本文将详细介绍SEO的各个方面，包括SEO关键词优化、SEO内容策略、SEO技术实施等重要的SEO概念。通过学习这些SEO技巧，你可以大幅提升网站的SEO表现。</p>

            <h2>什么是SEO及其重要性</h2>
            <p>搜索引擎优化（Search Engine Optimization，简称SEO）是一种通过优化网站内容和结构来提高搜索引擎排名的策略。</p>

            <h3>SEO的核心要素</h3>
            <p>SEO包含多个重要要素：关键词研究、内容优化、技术SEO、链接建设等。</p>

            <h6>这是一个跳级的H6标题</h6>
            <p>这个标题违反了层级规则，应该被检测出来。</p>

            <h2>关键词研究与优化策略</h2>
            <p>关键词研究是SEO的基础工作。正确的关键词策略可以帮助网站获得更好的搜索排名。</p>

            <p>这是一个故意写得非常长的句子，它包含了大量的从句和复杂的语法结构，目的是为了测试可读性分析工具是否能够准确识别出句子过长的问题，并且能够给出相应的优化建议，这样的长句在实际的内容写作中应该尽量避免，因为它会严重影响读者的阅读体验和内容的整体可读性。</p>

            <h2>内部链接优化</h2>
            <p>内部链接对SEO非常重要。以下是一些内部链接示例：</p>
            <ul>
                <li><a href="/seo-guide">完整SEO指南</a></li>
                <li><a href="/keyword-research">关键词研究工具</a></li>
                <li><a href="/content-optimization">内容优化技巧</a></li>
                <li><a href="/empty-link"></a></li>
                <li><a href="/click-here">点击这里</a></li>
            </ul>

            <h2>总结</h2>
            <p>SEO是一个复杂但重要的领域。通过系统学习和实践，可以掌握有效的SEO技巧。</p>
        `;

        const testKeywords = ['SEO', '搜索引擎优化', '关键词', '网站优化', '排名'];

        // 模拟SEO分析器类（简化版本，用于演示）
        class MockSEOAnalyzer {
            analyzeKeywords(content, keywords) {
                const words = content.replace(/<[^>]*>/g, '').split(/\s+/);
                const totalWords = words.length;

                const analysis = keywords.map(keyword => {
                    const regex = new RegExp(keyword, 'gi');
                    const matches = content.match(regex) || [];
                    const count = matches.length;
                    const density = ((count / totalWords) * 100).toFixed(2);

                    let recommendation;
                    if (density < 0.5) {
                        recommendation = { level: 'low', message: '关键词密度过低，建议适当增加' };
                    } else if (density > 3) {
                        recommendation = { level: 'high', message: '关键词密度过高，可能被视为关键词堆砌' };
                    } else {
                        recommendation = { level: 'optimal', message: '关键词密度适中' };
                    }

                    return { keyword, count, density: parseFloat(density), recommendation };
                });

                return {
                    totalWords,
                    keywordAnalysis: analysis,
                    overallScore: Math.round(analysis.reduce((sum, item) => {
                        if (item.recommendation.level === 'optimal') return sum + 100;
                        if (item.recommendation.level === 'low') return sum + 60;
                        return sum + 30;
                    }, 0) / analysis.length)
                };
            }

            analyzeHeadings(content) {
                const headingRegex = /<h([1-6])[^>]*>(.*?)<\/h[1-6]>/gi;
                const headings = [];
                let match;

                while ((match = headingRegex.exec(content)) !== null) {
                    headings.push({
                        level: parseInt(match[1]),
                        text: match[2].replace(/<[^>]*>/g, '').trim()
                    });
                }

                const issues = [];
                const h1Count = headings.filter(h => h.level === 1).length;

                if (h1Count === 0) {
                    issues.push({ type: 'missing_h1', severity: 'high', message: '缺少H1标签' });
                } else if (h1Count > 1) {
                    issues.push({ type: 'multiple_h1', severity: 'high', message: `发现${h1Count}个H1标签` });
                }

                // 检查层级跳跃
                for (let i = 1; i < headings.length; i++) {
                    if (headings[i].level - headings[i - 1].level > 1) {
                        issues.push({
                            type: 'heading_skip',
                            severity: 'medium',
                            message: `标题层级跳跃：从H${headings[i - 1].level}跳到H${headings[i].level}`
                        });
                    }
                }

                return {
                    headings,
                    issues,
                    score: Math.max(0, 100 - issues.length * 15)
                };
            }

            analyzeReadability(content) {
                const cleanText = content.replace(/<[^>]*>/g, ' ').replace(/\s+/g, ' ').trim();
                const sentences = cleanText.split(/[.!?。！？]+/).filter(s => s.trim().length > 5);
                const words = cleanText.split(/\s+/).filter(w => w.length > 0);
                const paragraphs = content.split(/\n\s*\n|<\/p>|<br\s*\/?>/i).filter(p => p.trim().length > 10);

                const avgWordsPerSentence = sentences.length > 0 ? words.length / sentences.length : 0;
                const readingTime = Math.ceil(words.length / 200);

                const recommendations = [];
                if (avgWordsPerSentence > 20) {
                    recommendations.push({ message: '句子过长，建议拆分为短句' });
                }
                if (paragraphs.length > 0 && sentences.length / paragraphs.length > 5) {
                    recommendations.push({ message: '段落过长，建议分解' });
                }

                return {
                    metrics: {
                        wordCount: words.length,
                        sentenceCount: sentences.length,
                        paragraphCount: paragraphs.length,
                        averageWordsPerSentence: Math.round(avgWordsPerSentence * 10) / 10,
                        readingTime
                    },
                    recommendations,
                    score: Math.max(0, 100 - recommendations.length * 20)
                };
            }

            analyzeLinks(content) {
                const linkRegex = /<a[^>]+href=["']([^"']+)["'][^>]*>(.*?)<\/a>/gi;
                const links = [];
                let match;

                while ((match = linkRegex.exec(content)) !== null) {
                    links.push({
                        href: match[1],
                        anchorText: match[2].replace(/<[^>]*>/g, '').trim()
                    });
                }

                const emptyAnchors = links.filter(link => !link.anchorText).length;
                const totalWords = content.replace(/<[^>]*>/g, '').split(/\s+/).length;
                const linkDensity = totalWords > 0 ? ((links.length / totalWords) * 100).toFixed(2) : 0;

                const suggestions = [];
                if (emptyAnchors > 0) {
                    suggestions.push({ message: `发现${emptyAnchors}个空锚文本链接` });
                }
                if (linkDensity > 5) {
                    suggestions.push({ message: '链接密度过高' });
                } else if (linkDensity < 1) {
                    suggestions.push({ message: '链接密度过低' });
                }

                return {
                    links,
                    metrics: {
                        totalInternalLinks: links.length,
                        linkDensity: parseFloat(linkDensity),
                        emptyAnchorTexts: emptyAnchors
                    },
                    suggestions,
                    score: Math.max(0, 100 - suggestions.length * 20)
                };
            }

            analyzeContent(options) {
                const { content, keywords } = options;

                const keywordAnalysis = this.analyzeKeywords(content, keywords);
                const headingAnalysis = this.analyzeHeadings(content);
                const readabilityAnalysis = this.analyzeReadability(content);
                const linkAnalysis = this.analyzeLinks(content);

                const overallScore = Math.round(
                    (keywordAnalysis.overallScore + headingAnalysis.score +
                        readabilityAnalysis.score + linkAnalysis.score) / 4
                );

                return {
                    overallScore,
                    detailed: {
                        keywords: keywordAnalysis,
                        headings: headingAnalysis,
                        readability: readabilityAnalysis,
                        links: linkAnalysis
                    }
                };
            }
        }

        const analyzer = new MockSEOAnalyzer();

        function showLoading(elementId) {
            document.getElementById(elementId).innerHTML = '<div class="loading"></div> 分析中...';
        }

        function getScoreClass(score) {
            if (score >= 90) return 'score-excellent';
            if (score >= 80) return 'score-good';
            if (score >= 70) return 'score-fair';
            if (score >= 60) return 'score-poor';
            return 'score-very-poor';
        }

        function testFullAnalysis() {
            showLoading('fullAnalysisResult');

            setTimeout(() => {
                try {
                    const result = analyzer.analyzeContent({
                        content: testContent,
                        keywords: testKeywords
                    });

                    const html = `
                        <div class="success-box">
                            <h4>✅ 综合分析完成</h4>
                            <div class="score-circle ${getScoreClass(result.overallScore)}">
                                ${result.overallScore}
                            </div>
                            <p><strong>综合评分：</strong>${result.overallScore}/100</p>
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 10px; margin-top: 15px;">
                                <div>关键词: ${result.detailed.keywords.overallScore}/100</div>
                                <div>标题结构: ${result.detailed.headings.score}/100</div>
                                <div>可读性: ${result.detailed.readability.score}/100</div>
                                <div>内部链接: ${result.detailed.links.score}/100</div>
                            </div>
                        </div>
                    `;

                    document.getElementById('fullAnalysisResult').innerHTML = html;
                } catch (error) {
                    document.getElementById('fullAnalysisResult').innerHTML =
                        `<div class="error-box">❌ 分析失败: ${error.message}</div>`;
                }
            }, 1000);
        }

        function testKeywordAnalysis() {
            showLoading('keywordResult');

            setTimeout(() => {
                try {
                    const result = analyzer.analyzeKeywords(testContent, testKeywords);

                    let html = `
                        <div class="success-box">
                            <h4>✅ 关键词分析完成</h4>
                            <p><strong>总词数：</strong>${result.totalWords}</p>
                            <p><strong>评分：</strong>${result.overallScore}/100</p>
                        </div>
                        <div class="result-box">
                            <h5>关键词密度详情：</h5>
                    `;

                    result.keywordAnalysis.forEach(item => {
                        const levelColor = item.recommendation.level === 'optimal' ? '#28a745' :
                            item.recommendation.level === 'low' ? '#ffc107' : '#dc3545';
                        html += `
                            <div style="margin: 10px 0; padding: 10px; border-left: 4px solid ${levelColor}; background: #f8f9fa;">
                                <strong>${item.keyword}:</strong> ${item.count}次 (${item.density}%)
                                <br><small>${item.recommendation.message}</small>
                            </div>
                        `;
                    });

                    html += '</div>';
                    document.getElementById('keywordResult').innerHTML = html;
                } catch (error) {
                    document.getElementById('keywordResult').innerHTML =
                        `<div class="error-box">❌ 分析失败: ${error.message}</div>`;
                }
            }, 800);
        }

        function testHeadingStructure() {
            showLoading('headingResult');

            setTimeout(() => {
                try {
                    const result = analyzer.analyzeHeadings(testContent);

                    let html = `
                        <div class="success-box">
                            <h4>✅ 标题结构分析完成</h4>
                            <p><strong>评分：</strong>${result.score}/100</p>
                            <p><strong>发现标题：</strong>${result.headings.length}个</p>
                        </div>
                    `;

                    if (result.headings.length > 0) {
                        html += '<div class="result-box"><h5>标题列表：</h5>';
                        result.headings.forEach(heading => {
                            html += `<div style="margin: 5px 0; padding-left: ${(heading.level - 1) * 20}px;">
                                H${heading.level}: ${heading.text}
                            </div>`;
                        });
                        html += '</div>';
                    }

                    if (result.issues.length > 0) {
                        html += '<div class="result-box"><h5>发现的问题：</h5>';
                        result.issues.forEach(issue => {
                            const severityColor = issue.severity === 'high' ? '#dc3545' :
                                issue.severity === 'medium' ? '#ffc107' : '#007bff';
                            html += `
                                <div style="margin: 5px 0; padding: 8px; border-left: 4px solid ${severityColor}; background: #f8f9fa;">
                                    <strong>${issue.severity.toUpperCase()}:</strong> ${issue.message}
                                </div>
                            `;
                        });
                        html += '</div>';
                    }

                    document.getElementById('headingResult').innerHTML = html;
                } catch (error) {
                    document.getElementById('headingResult').innerHTML =
                        `<div class="error-box">❌ 分析失败: ${error.message}</div>`;
                }
            }, 600);
        }

        function testReadability() {
            showLoading('readabilityResult');

            setTimeout(() => {
                try {
                    const result = analyzer.analyzeReadability(testContent);

                    let html = `
                        <div class="success-box">
                            <h4>✅ 可读性分析完成</h4>
                            <p><strong>评分：</strong>${result.score}/100</p>
                        </div>
                        <div class="result-box">
                            <h5>内容指标：</h5>
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 10px;">
                                <div>词数: ${result.metrics.wordCount}</div>
                                <div>句子数: ${result.metrics.sentenceCount}</div>
                                <div>段落数: ${result.metrics.paragraphCount}</div>
                                <div>平均句长: ${result.metrics.averageWordsPerSentence}词</div>
                                <div>阅读时间: ${result.metrics.readingTime}分钟</div>
                            </div>
                        </div>
                    `;

                    if (result.recommendations.length > 0) {
                        html += '<div class="result-box"><h5>优化建议：</h5>';
                        result.recommendations.forEach(rec => {
                            html += `<div style="margin: 5px 0; padding: 8px; background: #fff3cd; border-left: 4px solid #ffc107;">
                                ${rec.message}
                            </div>`;
                        });
                        html += '</div>';
                    }

                    document.getElementById('readabilityResult').innerHTML = html;
                } catch (error) {
                    document.getElementById('readabilityResult').innerHTML =
                        `<div class="error-box">❌ 分析失败: ${error.message}</div>`;
                }
            }, 700);
        }

        function testLinkAnalysis() {
            showLoading('linkResult');

            setTimeout(() => {
                try {
                    const result = analyzer.analyzeLinks(testContent);

                    let html = `
                        <div class="success-box">
                            <h4>✅ 链接分析完成</h4>
                            <p><strong>评分：</strong>${result.score}/100</p>
                        </div>
                        <div class="result-box">
                            <h5>链接指标：</h5>
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 10px;">
                                <div>内部链接: ${result.metrics.totalInternalLinks}个</div>
                                <div>链接密度: ${result.metrics.linkDensity}%</div>
                                <div>空锚文本: ${result.metrics.emptyAnchorTexts}个</div>
                            </div>
                        </div>
                    `;

                    if (result.links.length > 0) {
                        html += '<div class="result-box"><h5>链接列表：</h5>';
                        result.links.forEach(link => {
                            const anchorText = link.anchorText || '(空锚文本)';
                            const textColor = link.anchorText ? '#007bff' : '#dc3545';
                            html += `
                                <div style="margin: 5px 0; padding: 8px; background: #f8f9fa; border-radius: 4px;">
                                    <strong style="color: ${textColor};">${anchorText}</strong>
                                    <br><small style="color: #6c757d;">${link.href}</small>
                                </div>
                            `;
                        });
                        html += '</div>';
                    }

                    if (result.suggestions.length > 0) {
                        html += '<div class="result-box"><h5>优化建议：</h5>';
                        result.suggestions.forEach(suggestion => {
                            html += `<div style="margin: 5px 0; padding: 8px; background: #fff3cd; border-left: 4px solid #ffc107;">
                                ${suggestion.message}
                            </div>`;
                        });
                        html += '</div>';
                    }

                    document.getElementById('linkResult').innerHTML = html;
                } catch (error) {
                    document.getElementById('linkResult').innerHTML =
                        `<div class="error-box">❌ 分析失败: ${error.message}</div>`;
                }
            }, 900);
        }

        // 页面加载完成后的提示
        window.addEventListener('load', function () {
            console.log('SEO分析工具测试页面加载完成');
            console.log('可以开始测试各项功能');
        });
    </script>
</body>

</html>